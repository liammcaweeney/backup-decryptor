{"version":3,"sources":["utils/helpers.ts","copy.svg","App.tsx","index.tsx"],"names":["generateMasterSeedPhrase","masterPassword","masterKeystore","a","decryptFromKeystore","keystore","password","_decryptFromKeystore","WalletDecryptor","masterSeedPhrase","getMasterSeedPhrase","getSeedPhrase","walletKeystore","keyStore","ed25519","publickeys","pubKey","data","Array","from","toBuffer","string","toString","CryptoJS","SHA256","enc","Hex","this","fromPassword","masterKeyStore","fromRecoveryCode","recoveryCode","entropy","bip39","App","useState","filename","setFilename","backupFileJSON","setBackupFileJSON","keyStores","setKeyStores","setPassword","setRecoveryCode","useRecoveryCode","setUseRecoveryCode","undefined","setMasterKeyStores","seedPhrases","setSeedPhrases","error","setError","useEffect","console","log","masterKey","wallets","Object","values","accounts","map","wallet","walletInfo","label","criticalData","rootKeystore","rootLabel","e","inputRef","useRef","getSeedPhraseFromWallet","walletDecryptor","Promise","allSettled","then","phrases","promises","successfullPromises","filter","promise","status","value","catch","handleSubmit","preventDefault","className","type","name","ref","style","display","required","onChange","target","files","length","file","fr","FileReader","readAsText","onloadend","result","backupFile","JSON","parse","err","onClick","current","click","onSubmit","placeholder","title","seedPhrase","src","CopyIcon","navigator","clipboard","writeText","alert","alt","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.476d8720.chunk.js","sourcesContent":["import CryptoJS from 'crypto-js'\nimport {\n  decryptFromKeystore as _decryptFromKeystore,\n  Keystore as xchainKeystore,\n} from '@xchainjs/xchain-crypto'\nimport * as bip39 from 'bip39'\n\nconst generateMasterSeedPhrase = async (\n  masterPassword: string,\n  masterKeystore: any\n): Promise<string> => {\n  return decryptFromKeystore(masterKeystore, masterPassword)\n}\nexport const entropyToPhrase = (entropy: string): string => {\n  return bip39.entropyToMnemonic(entropy)\n}\n\nconst hashStringValue = (string: string) => {\n  return CryptoJS.SHA256(string).toString(CryptoJS.enc.Hex)\n}\n\nconst decryptFromKeystore = async (\n  keystore: any,\n  password: string\n): Promise<string> => {\n  return  _decryptFromKeystore(\n    keystore as xchainKeystore,\n    password\n  )\n}\nexport class WalletDecryptor {\n  private readonly masterSeedPhrase: string\n\n  constructor(masterSeedPhrase: string) {\n    this.masterSeedPhrase = masterSeedPhrase\n  }\n\n  public static fromPassword = async (masterPassword: string, masterKeyStore: any) => {\n    const masterSeedPhrase = await generateMasterSeedPhrase(masterPassword, masterKeyStore)\n    return new WalletDecryptor(masterSeedPhrase);\n  };\n\n  public static fromRecoveryCode = async (recoveryCode: string) => {\n    const masterSeedPhrase = await entropyToPhrase(recoveryCode)\n    return new WalletDecryptor(masterSeedPhrase);\n  };\n\n  getMasterSeedPhrase = () => this.masterSeedPhrase\n\n\n  getSeedPhrase = async (\n    walletKeystore: any\n  ): Promise<string> => {\n    const keyStore = walletKeystore?.keystore ? walletKeystore.keystore : walletKeystore\n    const { ed25519 } = keyStore.publickeys\n    const pubKey = ed25519.pubKey.data || Array.from(ed25519.toBuffer())\n    const password = hashStringValue(`${this.masterSeedPhrase}${pubKey.toString()}`)\n    return decryptFromKeystore(keyStore, password)\n  }\n}\n","export default __webpack_public_path__ + \"static/media/copy.c0a32f3c.svg\";","import './App.css';\nimport React, { useState, useRef, useEffect } from 'react'\nimport { WalletDecryptor } from './utils/helpers'\nimport CopyIcon from './copy.svg'\ninterface Phrase {\n  label: string\n  phrase: string\n}\n\nfunction App() {\n  const[filename, setFilename] = useState('')\n  const[backupFileJSON, setBackupFileJSON] = useState<any>()\n  const[keyStores, setKeyStores] = useState<any>([])\n  const[password, setPassword] = useState<string>(\"\")\n  const[recoveryCode, setRecoveryCode] = useState<string>(\"\")\n  const[useRecoveryCode, setUseRecoveryCode] = useState<boolean>(false)\n  const[masterKeyStore, setMasterKeyStores] = useState<any>(undefined)\n  const[seedPhrases, setSeedPhrases] = useState<any>([])\n  const[error, setError] = useState<string>(\"\")\n\n  useEffect(() => {\n    try{\n      if (backupFileJSON) {\n        setError(\"\")\n        setPassword(\"\")\n        setSeedPhrases([])\n        setRecoveryCode(\"\")\n        console.log(backupFileJSON)\n        if(backupFileJSON.masterKey) {\n          setMasterKeyStores(backupFileJSON.masterKey)\n          const wallets = Object.values(backupFileJSON?.accounts?.wallets)\n          setKeyStores(wallets.map((wallet: any) => ({ ...wallet.walletInfo.data, label: wallet.label })))\n        } else if(backupFileJSON.masterKeystore) {\n          setMasterKeyStores(backupFileJSON.masterKeystore.keystore.masterKey)\n          const wallets = Object.values(backupFileJSON?.wallets?.wallets)\n          setKeyStores(wallets.map((wallet: any) => ({ ...wallet.walletInfo.data, label: wallet.label })))\n        } else if(backupFileJSON.criticalData) {\n          setMasterKeyStores(backupFileJSON.criticalData.masterKey)\n          const wallets = Object.values(backupFileJSON?.accounts?.wallets)\n          setKeyStores(wallets.map((wallet: any) => ({ ...wallet.walletInfo.data, label: wallet.label })))\n        } else if(backupFileJSON.rootKeystore) {\n          setMasterKeyStores(undefined)\n          setKeyStores([{ ...backupFileJSON.rootKeystore, label: backupFileJSON.rootLabel }])\n        } else {\n          setMasterKeyStores(undefined)\n          setKeyStores([{ ...backupFileJSON, label: 'Seed Phrase' }])\n        }\n      }\n    } catch(e) {\n      console.error(e)\n    }\n\n  }, [backupFileJSON])\n\n  const inputRef = useRef<HTMLInputElement>(null)\n\n  const handlerBrowse = (): void => {\n    if (inputRef && inputRef.current) inputRef.current.click()\n  }\n\n  const handlerFileChange = ({ target }: React.ChangeEvent<HTMLInputElement>): void => {\n    if (!target) return\n\n    const { files } = target\n\n    if (!files) {\n      setFilename('Browse')\n      return\n    }\n\n    if (files.length) {\n      const file = files[0]\n      setFilename(file.name)\n      const fr = new FileReader()\n\n      fr.readAsText(file)\n      fr.onloadend = (e): void => {\n        if (!e.target || !e.target.result) return\n        try {\n          const backupFile = JSON.parse(e.target.result.toString())\n          setBackupFileJSON(backupFile)\n        } catch (err) {\n          console.log(err)\n        }\n      }\n    }\n  }\n\n  const getSeedPhraseFromWallet = ( walletDecryptor: any) => {\n    Promise.allSettled<Phrase>(keyStores.map((keyStore: any) => {\n        return walletDecryptor.getSeedPhrase(keyStore).then((phrases: any) => {\n          return { label: keyStore.label, phrases }\n        })\n      })\n    ).then((promises: PromiseSettledResult<Phrase>[]) => {\n        // @ts-ignore\n      const successfullPromises = promises.filter(promise => promise.status === 'fulfilled').map((promise: PromiseFulfilledResult<Phrase>) => promise.value)\n        setSeedPhrases(successfullPromises)\n        setError(\"\")\n      })\n      .catch(e => {\n        console.error(e)\n        setSeedPhrases([])\n        setError(e)\n      })\n  }\n\n  const handleSubmit = async (e: any) => {\n    e.preventDefault();\n    if(!masterKeyStore) {\n      WalletDecryptor.fromPassword(password, keyStores[0]).then(walletDecryptor =>{\n        return [{ label: keyStores[0].label, phrases: walletDecryptor.getMasterSeedPhrase() }]\n      }).then(phrases => {\n          setSeedPhrases(phrases)\n          setError(\"\")\n        })\n        .catch(e => {\n          console.error(e)\n          setSeedPhrases([])\n          setError(e)\n        })\n    }\n    else {\n      if (useRecoveryCode) {\n        WalletDecryptor.fromRecoveryCode(recoveryCode)\n          .then(getSeedPhraseFromWallet)\n          .catch(e => {\n            console.error(e)\n            setSeedPhrases([])\n            setError(e)\n        })\n      } else\n        WalletDecryptor.fromPassword(password, masterKeyStore)\n          .then(getSeedPhraseFromWallet)\n          .catch(e => {\n            console.error(e)\n            setSeedPhrases([])\n            setError(e)\n        })\n    }\n\n  }\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        XDEFI Backup Decryptor\n      </header>\n      <h2>\n        Select the a backup file to be decrypted\n      </h2>\n      <div className=\"body\">\n        {filename===''}\n        <input\n          type=\"file\"\n          name=\"file\"\n          ref={inputRef}\n          style={{ display: 'none' }}\n          required\n          onChange={handlerFileChange}\n        />\n        <div className=\"fileSelection\">\n          Select File <button onClick={handlerBrowse}> {filename==='' ? 'Browse Files' : filename} </button>\n        </div>\n\n        {!!keyStores.length &&\n          <form onSubmit={handleSubmit}>\n            <div className=\"password\">\n              {useRecoveryCode ?(<div>\n                  Recovery Code <input\n                  placeholder='  recovery code'\n                  onChange={e => setRecoveryCode(e.target.value)}\n                  type=\"text\" title=\"recoveryCode\"\n                  name=\"recoveryCode\"\n                  value={recoveryCode}\n                />\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    setUseRecoveryCode(false)}\n                  }\n                > Switch to password</button>\n                </div>\n              ):(<div>\n                Password <input\n                placeholder='  password'\n                onChange={e => setPassword(e.target.value)}\n                type=\"password\" title=\"password\"\n                name=\"password\" value={password}\n              />\n                {masterKeyStore && <button\n                    type=\"button\"\n                    onClick={() => {\n                      setUseRecoveryCode(true)\n                    }}\n                >\n                    Switch to Recovery Code\n                </button>\n                }\n              </div>)\n              }\n            </div>\n            <button type=\"submit\">Get Seed Phrase</button>\n          </form>\n        }\n        <div className=\"accounts\">\n          {seedPhrases.map((seedPhrase: any) => {\n            return (\n              <div className=\"account\" key={seedPhrase.label}>\n                {seedPhrase.label}: {seedPhrase.phrases}\n                <img\n                  src={CopyIcon}\n                  onClick={() => {\n                    navigator.clipboard.writeText(seedPhrase.phrases)\n                      .then(() => alert('Copied seed phrase'))}\n                  }\n                  alt={'copy'}/>\n              </div>\n            )\n          })}\n        </div>\n        {error !=='' && <div className=\"error\"> {error} </div> }\n      </div>\n    </div>\n  );\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}